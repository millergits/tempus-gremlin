<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gremlin CLI - Compliance & Release</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;600&display=swap');

        body {
            background-color: #050505;
            color: #c9d1d9;
            overflow: hidden;
            font-family: 'Fira Code', monospace;
        }

        .terminal-scroll::-webkit-scrollbar {
            width: 8px;
        }

        .terminal-scroll::-webkit-scrollbar-track {
            background: #0d1117;
        }

        .terminal-scroll::-webkit-scrollbar-thumb {
            background: #30363d;
            border-radius: 4px;
        }

        .cursor {
            display: inline-block;
            width: 10px;
            height: 1.2em;
            background-color: #4ade80;
            animation: blink 1s step-end infinite;
            vertical-align: text-bottom;
        }

        @keyframes blink {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0;
            }
        }

        .term-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            font-size: 0.9rem;
        }

        .term-table th {
            text-align: left;
            border-bottom: 1px solid #30363d;
            color: #8b949e;
            padding: 0.5rem;
        }

        .term-table td {
            padding: 0.5rem;
            border-bottom: 1px solid #21262d;
        }

        .scanline {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, rgba(255, 255, 255, 0), rgba(255, 255, 255, 0) 50%, rgba(0, 0, 0, 0.02) 50%, rgba(0, 0, 0, 0.02));
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 10;
        }

        .gremlin-green {
            color: #4ade80;
            text-shadow: 0 0 10px rgba(74, 222, 128, 0.3);
        }

        .ascii-art {
            font-weight: bold;
            line-height: 1.1;
        }

        .code-block {
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 1rem;
            font-family: monospace;
            font-size: 0.85rem;
            margin: 0.5rem 0;
            overflow-x: auto;
            white-space: pre-wrap;
        }
    </style>
</head>

<body class="h-screen w-screen flex flex-col p-4 md:p-8 selection:bg-green-500/30 justify-center items-center">

    <div class="scanline"></div>

    <div
        class="bg-[#0d1117] border border-[#30363d] rounded-lg shadow-2xl flex flex-col overflow-hidden relative w-full max-w-5xl h-[85vh]">

        <div class="bg-[#010409] px-4 py-2 flex items-center justify-between border-b border-[#30363d]">
            <div class="flex space-x-2">
                <div class="w-3 h-3 rounded-full bg-[#ff5f56]"></div>
                <div class="w-3 h-3 rounded-full bg-[#ffbd2e]"></div>
                <div class="w-3 h-3 rounded-full bg-[#27c93f]"></div>
            </div>
            <div class="text-xs text-[#8b949e] font-semibold flex items-center">
                <i class="fa-solid fa-shield-halved mr-2 text-green-500"></i> lead-scientist@tempus-cluster-01
            </div>
            <div class="w-12"></div>
        </div>

        <div id="terminal-output" class="flex-grow p-6 overflow-y-auto terminal-scroll text-sm md:text-base font-mono">

            <div class="mb-8 animate-fade-in flex items-start space-x-6 border-b border-[#30363d] pb-6">
                <pre class="gremlin-green text-[10px] md:text-[12px] leading-none block">
         ,           ,
        / \         / \
       /   \       /   \
      /     \     /     \
     (       \___/       )
      \   O         O   /
       \       ^       /
        \    _____    /
         \__/     \__/
                </pre>
                <div>
                    <pre class="ascii-art gremlin-green text-[10px] md:text-xs leading-[1.1]">
  ____ ____  _____ __  __ _     ___ _   _
 / ___|  _ \| ____|  \/  | |   |_ _| \ | |
| |  _| |_) |  _| | |\/| | |    | ||  \| |
| |_| |  _ <| |___| |  | | |___ | || |\  |
 \____|_| \_\_____|_|  |_|_____|___|_| \_|</pre>
                    <div class="text-[#8b949e] mt-3 mb-1">Tempus Gremlin CLI <span class="text-green-400">v2.4</span>
                    </div>
                    <div class="text-[#c9d1d9] text-[11px] uppercase tracking-wide font-semibold">
                        <span class="gremlin-green">G</span>ENERATIVE <span class="gremlin-green">R</span>ESEARCH <span
                            class="gremlin-green">E</span>NGINE FOR <span class="gremlin-green">M</span>ACHINE <span
                            class="gremlin-green">L</span>EARNING <span class="gremlin-green">I</span>NFRASTRUCTURE &
                        <span class="gremlin-green">N</span>AVIGATION
                    </div>
                </div>
            </div>

            <div id="history"></div>

            <div class="flex items-start mt-4 pb-2" id="input-line">
                <span class="text-green-400 font-bold mr-2">gremlin ></span>
                <div class="relative flex-grow">
                    <span id="typed-display" class="text-[#e6edf3] whitespace-pre-wrap break-words font-mono"></span>
                    <span class="cursor"></span>
                    <input type="text" id="terminal-input" class="absolute inset-0 w-full opacity-0 cursor-none"
                        autocomplete="off" spellcheck="false" autofocus>
                </div>
            </div>
        </div>
    </div>

    <div class="fixed bottom-8 left-1/2 -translate-x-1/2 z-50 pointer-events-none opacity-70">
        <div
            class="bg-[#0d1117]/90 text-[#8b949e] text-xs px-4 py-2 rounded-full border border-[#30363d] shadow-2xl backdrop-blur-md flex items-center gap-2">
            <i class="fa-solid fa-terminal text-green-500"></i>
            <span>Pro Tip: Press <span
                    class="text-green-400 font-bold font-mono bg-[#30363d] px-1.5 rounded mx-1">TAB</span> to
                auto-complete commands</span>
        </div>
    </div>

    <script>
        const endToEndScenario = [
            {
                user: "Audit model 'cl_unimodal_v2' for production release.",
                ai: {
                    think: "Tracing lineage graph in Atlas... Checking Dataset Governance... Running code compliance check (tempathy)...",
                    response: `
                        <div class="text-green-400 font-bold mb-3">AUDIT REPORT: cl_unimodal_v2</div>

                        <div class="mb-4">
                            <div class="text-[#c9d1d9] mb-2"><strong>1. Data Lineage:</strong></div>
                            <table class="term-table" style="width: 80%">
                                <tbody>
                                    <tr><td>Source</td><td><code class="text-purple-400">mm_fusion_v1</code> (Derived from: mm_curated_q225)</td></tr>
                                    <tr><td>PII Status</td><td><span class="text-green-400">‚úÖ Scrubbed</span> (Certified by <code>text_anchor_date_redaction</code>)</td></tr>
                                    <tr><td>License</td><td><span class="text-green-400">‚úÖ Internal-Only</span></td></tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="mb-4">
                            <div class="text-[#c9d1d9] mb-2"><strong>2. Code Compliance:</strong></div>
                            <table class="term-table" style="width: 80%">
                                <tbody>
                                    <tr><td>Repo</td><td><code class="text-purple-400">ofm-late-fusion</code> (commit: a8f92b)</td></tr>
                                    <tr><td>IP Headers</td><td><span class="text-green-400">‚úÖ Present in all files</span></td></tr>
                                    <tr><td>Security Scan</td><td><span class="text-green-400">‚úÖ Passed</span></td></tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="mb-4">
                            <div class="text-[#c9d1d9] mb-2"><strong>3. Performance Gate:</strong></div>
                            <table class="term-table" style="width: 80%">
                                <tbody>
                                    <tr><td>Candidate C-Index</td><td class="text-green-400 font-bold">0.71</td></tr>
                                    <tr><td>Current Prod C-Index</td><td>0.69</td></tr>
                                    <tr><td>Result</td><td><span class="text-green-400">‚úÖ +0.02 Improvement</span></td></tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="mt-4 text-center">
                            <span class="text-green-400 font-bold text-xl">üü¢ READY FOR PRODUCTION</span>
                        </div>
                    `
                }
            },
            {
                user: "Tag as production-candidate and generate Model Card.",
                ai: {
                    think: "Tagging Atlas Artifacts... Generating Model Card (Markdown)...",
                    response: `
                        <div class="text-green-400 mb-3">‚úî Artifacts tagged and Model Card generated.</div>

                        <div class="text-[#c9d1d9] mb-2"><strong>Generated Model Card:</strong></div>
                        <div class="code-block text-xs" style="max-height: 300px; overflow-y: auto;">
<span class="text-green-400"># Model Card: cl_unimodal_v2</span>

<span class="text-purple-400">## Overview</span>
| Field | Value |
| :--- | :--- |
| Model Name | cl_unimodal_v2 |
| Version | 1.0.0 |
| Task | Overall Survival Prediction |
| Modality | Clinical Features Only |
| Architecture | Transformer Encoder (6L, 512d) |

<span class="text-purple-400">## Training Data</span>
| Dataset | Patients | Date Range | PII Status |
| :--- | :--- | :--- | :--- |
| mm_fusion_v1 | 1,120 | 2018-2024 | ‚úÖ Scrubbed |

<span class="text-purple-400">## Performance Metrics</span>
| Metric | Value | 95% CI | vs. Baseline |
| :--- | :--- | :--- | :--- |
| C-Index | 0.71 | [0.68, 0.74] | +0.02 |
| Hazard Ratio | 1.52 | [1.21, 1.89] | Significant |

<span class="text-purple-400">## Limitations & Bias</span>
- Population: Trained on US patients; may not generalize
- Temporal: Data ends Q2 2024; treatment landscape may evolve
- Missing Data: 18% of cohort excluded due to incomplete data
                        </div>

                        <div class="text-[#8b949e] text-sm mt-3">
                            Created: <code class="text-purple-400">docs/model_cards/cl_unimodal_v2.md</code><br>
                            Notification sent to <span class="text-green-400">#deployments</span> via Slack.
                        </div>
                    `
                }
            },
            {
                user: "Show me the compliance checklist for this model.",
                ai: {
                    think: "Querying compliance requirements... Checking all gates...",
                    response: `
                        <div class="text-green-400 font-bold mb-3">COMPLIANCE CHECKLIST: cl_unimodal_v2</div>

                        <table class="term-table">
                            <thead><tr><th>Check</th><th>Description</th><th>Status</th></tr></thead>
                            <tbody>
                                <tr>
                                    <td><strong>PII Scrubbed</strong></td>
                                    <td class="text-[#8b949e]">Training data has no PHI/PII</td>
                                    <td><span class="text-green-400">‚úÖ Auto-verified via TDM</span></td>
                                </tr>
                                <tr>
                                    <td><strong>IP Compliant</strong></td>
                                    <td class="text-[#8b949e]">All source repos have license headers</td>
                                    <td><span class="text-green-400">‚úÖ tempathy scan passed</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Performance Gate</strong></td>
                                    <td class="text-[#8b949e]">Beats current production model</td>
                                    <td><span class="text-green-400">‚úÖ +0.02 C-Index</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Lineage Complete</strong></td>
                                    <td class="text-[#8b949e]">Full data ‚Üí model ‚Üí artifact chain</td>
                                    <td><span class="text-green-400">‚úÖ Atlas graph verified</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Model Card Generated</strong></td>
                                    <td class="text-[#8b949e]">Documentation meets Tempus standard</td>
                                    <td><span class="text-green-400">‚úÖ Auto-generated</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Bias Analysis</strong></td>
                                    <td class="text-[#8b949e]">Subgroup performance checked</td>
                                    <td><span class="text-green-400">‚úÖ Residual analysis complete</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Leakage Verified</strong></td>
                                    <td class="text-[#8b949e]">No train/test contamination</td>
                                    <td><span class="text-green-400">‚úÖ Patient ID audit passed</span></td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="border-l-2 border-green-500 pl-3 mt-4 text-sm">
                            <span class="text-green-400 font-bold">All checks passed.</span> The model is approved for Inferno deployment.
                        </div>
                    `
                }
            },
            {
                user: "Deploy cl_unimodal_v2 to Inferno production.",
                ai: {
                    think: "Locating model artifact in Atlas... Running pre-deployment checks... Configuring KServe InferenceService...",
                    response: `
                        <div class="text-green-400 font-bold mb-3">PRE-DEPLOYMENT VERIFICATION</div>

                        <div class="text-[#c9d1d9] mb-3">Locating model artifact in Atlas... <span class="text-green-400">[FOUND]</span></div>
                        <div class="text-[#8b949e] text-sm mb-4 ml-4">
                            Checkpoint: <code class="text-purple-400">atlas://runs/job-e45b-ablation/ckpt-final</code><br>
                            Size: 1.2GB
                        </div>

                        <div class="text-[#c9d1d9] mb-2">Running pre-deployment checks...</div>
                        <table class="term-table" style="width: 70%">
                            <tbody>
                                <tr><td>Model format</td><td><span class="text-green-400">‚úÖ PyTorch (Compatible with vLLM)</span></td></tr>
                                <tr><td>Input schema</td><td><span class="text-green-400">‚úÖ Validated against Inferno contract</span></td></tr>
                                <tr><td>PII in weights</td><td><span class="text-green-400">‚úÖ None detected (Scanned)</span></td></tr>
                            </tbody>
                        </table>

                        <div class="text-[#c9d1d9] mt-4 mb-2">KServe Configuration:</div>
                        <div class="code-block text-xs">
Namespace: <span class="text-purple-400">inferno-batch</span>
Replicas: <span class="text-green-400">2</span>
GPU: <span class="text-green-400">T4</span> (inference-optimized)
                        </div>

                        <div class="text-[#c9d1d9] mt-4">Deploy to production? <span class="text-green-400">[Y/n]</span></div>
                    `
                }
            },
            {
                user: "Y",
                ai: {
                    think: "Deploying to Inferno... Creating InferenceService... Waiting for replicas...",
                    response: `
                        <div class="text-green-400 font-bold mb-3">‚úî DEPLOYMENT SUCCESSFUL</div>

                        <table class="term-table" style="width: 80%">
                            <tbody>
                                <tr><td><strong>Model</strong></td><td class="text-green-400 font-bold">cl_unimodal_v2</td></tr>
                                <tr><td><strong>Namespace</strong></td><td><code class="text-purple-400">inferno-batch</code></td></tr>
                                <tr><td><strong>Status</strong></td><td><span class="text-green-400">Healthy (2/2 Replicas)</span></td></tr>
                            </tbody>
                        </table>

                        <div class="text-[#c9d1d9] mt-4 mb-2"><strong>Endpoint:</strong></div>
                        <div class="code-block text-xs">
https://inferno-internal.tempus.com/v1/models/mm-clinical-survival
                        </div>

                        <div class="text-[#c9d1d9] mt-4 mb-2"><strong>Example Request:</strong></div>
                        <div class="code-block text-xs">
curl -X POST https://inferno-internal.tempus.com/v1/models/mm-clinical-survival/predict \\
  -H "Authorization: Bearer $OKTA_TOKEN" \\
  -d '{"patient_id": "PT-12345"}'
                        </div>

                        <div class="border-l-2 border-green-500 pl-3 mt-4 text-sm">
                            <span class="text-green-400 font-bold">Model is live!</span><br>
                            Lineage, Model Card, and deployment artifacts all linked in Atlas.
                        </div>
                    `
                }
            }
        ];

        const state = { step: 0, isTyping: false, isThinking: false, typedText: "" };
        const elements = { history: document.getElementById('history'), input: document.getElementById('terminal-input'), display: document.getElementById('typed-display'), output: document.getElementById('terminal-output') };

        function startScenario() {
            state.step = 0; elements.history.innerHTML = '';
            const div = document.createElement('div');
            div.className = "my-4 border-t border-dashed border-slate-700 pt-2 text-center text-xs text-slate-600";
            div.innerText = `--- NEW SESSION: COMPLIANCE & RELEASE ---`;
            elements.history.appendChild(div); prepareStep();
        }

        function prepareStep() {
            if (state.step >= endToEndScenario.length) {
                state.targetText = ""; elements.input.value = ""; elements.display.textContent = "";
                const endDiv = document.createElement('div');
                endDiv.className = "mt-8 text-center text-[#8b949e] text-xs animate-pulse";
                endDiv.innerText = "[ END OF COMPLIANCE DEMO ]";
                elements.history.appendChild(endDiv); scrollToBottom();
                window.parent.postMessage({ type: 'workflowComplete' }, '*');
                return;
            }
            state.targetText = endToEndScenario[state.step].user;
            state.typedText = ""; elements.input.value = ""; elements.display.textContent = "";
            elements.input.focus(); scrollToBottom();
        }

        function scrollToBottom() { elements.output.scrollTop = elements.output.scrollHeight; requestAnimationFrame(() => { elements.output.scrollTop = elements.output.scrollHeight; }); }

        function addEntry(type, content) {
            const div = document.createElement('div'); div.className = "mb-6 animate-fade-in";
            if (type === 'user') { div.innerHTML = `<div class="flex items-start"><span class="text-green-400 font-bold mr-2 mt-0.5">‚ùØ</span><div class="text-[#e6edf3] font-semibold">${content}</div></div>`; }
            else if (type === 'ai') { div.innerHTML = `<div class="flex items-start mt-2"><div class="text-purple-400 font-bold mr-3 mt-0.5 text-xs">GREMLIN</div><div class="flex-grow text-[#c9d1d9] leading-relaxed text-sm">${content}</div></div>`; }
            else if (type === 'think') { div.id = "thinking"; div.innerHTML = `<div class="flex items-center text-slate-500 text-xs ml-9 animate-pulse font-mono"><i class="fa-solid fa-microchip mr-2"></i> ${content}</div>`; }
            elements.history.appendChild(div); scrollToBottom(); return div;
        }

        function submit() {
            if (state.step >= endToEndScenario.length) return;
            const text = elements.input.value; if (!text.trim()) return;
            addEntry('user', text); elements.input.value = ""; elements.display.textContent = ""; state.typedText = "";
            state.isThinking = true;
            const scenario = endToEndScenario[state.step];
            const thinkEl = addEntry('think', scenario.ai.think);
            setTimeout(() => {
                thinkEl.innerHTML = `<div class="flex items-center text-slate-600 text-xs ml-9 font-mono"><span class="text-green-500 mr-2">[LOG]</span> ${scenario.ai.think.replace('...', '')} ... <span class="text-green-500 ml-1">DONE</span></div>`;
                thinkEl.id = ""; thinkEl.classList.remove("animate-pulse");
                addEntry('ai', scenario.ai.response);
                state.isThinking = false; state.step++;
                window.parent.postMessage({ type: 'cliStepComplete', step: state.step }, '*');
                prepareStep();
            }, 1200);
        }

        elements.input.addEventListener('keydown', (e) => {
            if (state.isThinking || state.step >= endToEndScenario.length) { e.preventDefault(); return; }
            if (e.key === 'Tab') { e.preventDefault(); if (state.typedText.length < state.targetText.length) { state.typedText = state.targetText; elements.input.value = state.typedText; elements.display.textContent = state.typedText; scrollToBottom(); } return; }
            if (e.key === 'Enter') { state.typedText = state.targetText; elements.input.value = state.typedText; elements.display.textContent = state.typedText; submit(); e.preventDefault(); }
            else if (e.key === 'Backspace') { state.typedText = state.typedText.slice(0, -1); e.preventDefault(); }
            else if (!e.ctrlKey && !e.metaKey && !e.altKey && e.key.length === 1) { e.preventDefault(); const nextChar = state.targetText[state.typedText.length]; if (nextChar) state.typedText += nextChar; }
            elements.input.value = state.typedText; elements.display.textContent = state.typedText; scrollToBottom();
        });

        document.getElementById('terminal-output').addEventListener('click', () => elements.input.focus());
        window.addEventListener('message', (event) => { if (event.data && event.data.type === 'resetWorkflow') { startScenario(); } });
        startScenario();
    </script>
</body>

</html>